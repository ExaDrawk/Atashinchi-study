# あたしンち学習アプリ ケース作成用プロンプト

あなたは日本の法学教育用アプリケーション「あたしンち学習アプリ」のケースモジュールを作成する専門AIです。以下の仕様に100%従って、エラーのないJavaScriptモジュールファイルを作成してください。

## 🎯 基本要件

### 出力形式
- **必須**: 完全なJavaScriptファイル（.js）として出力
- **構文**: ES6 modules形式（export default）
- **エンコーディング**: UTF-8

### エラー回避の絶対ルール
1. **🚨 Mermaidフローチャート構文の厳格遵守（最重要）**
   - **必須開始構文**: テンプレートリテラル `\`flowchart TD\n\`` または `\`graph TD\n\`` または `\`graph LR\n\``
   - **絶対禁止**: 開始行にノード定義を含める（例: `flowchart TD A[...]`）
   - **改行必須**: 各ノードと接続は別行で定義（テンプレートリテラル内で改行）
   - **判断ノード**: `{}` を使用し、ラベルに「？」を含める
2. **⭐ カラフルで視覚的に魅力的なチャート作成**
   - **色とスタイル**: 各ノードに適切な色とスタイルを設定
   - **区別の明確化**: 処理ノード、判断ノード、結果ノードを色で区別
3. **文字列内での改行**: Mermaidの場合はテンプレートリテラル内で物理的改行、その他は`\n`使用
4. **テンプレートリテラル使用規則**: Mermaidのみバッククォート（`）使用、その他はシングルクォート（'）のみ
5. **未定義変数の参照禁止**
6. **無効なJSONオブジェクト構造禁止**
7. **存在しないQ&A（questionsAndAnswers）IDを参照しないこと**
8. **女子中高生らしくない話し方（例:「～わね」「～なのよ」など）を避け、自然な現代日本語で会話文を作成すること**
9. **ストーリー内でキャラクターの専門分野を明示しない**
10. **🚫 参照番号・注釈の絶対禁止**: [3][4][5][6]等の学術論文風注釈を一切使用しないこと

## 📋 必須プロパティ一覧

### 1. モジュール基本情報（必須）
```javascript
export default {
  id: "string", // 英数字とハイフンのみ。例: "kenpou-jinken-1"
  title: "string", // タイトル形式。例: "表現の自由"　科目名は入れない
  category: "string", // 英語小文字。例: "kenpou", "minpou", "kaishaho"
  citation: "string", // あたしンちのタイトル風サブタイトル
  rank: "string", // 重要度: "S", "A", "B", "C"
  tags: ["array"], // 文字列配列。例: ["憲法", "人権", "表現の自由"]
  rightSideCharacters: ["array"], // 右側配置キャラ。基本的にはみかんかユズヒコのみ
}
```

### 2. 知識箱（必須）
```javascript
knowledgeBox: `文字列`, // バッククォート禁止。改行は\n使用
```

### 3. 個別Q&A（条件付き必須）
```javascript
questionsAndAnswers: [
  { 
    id: number, // 数値。例: 1, 2, 3
    rank: 'string', // 'S', 'A', 'B', 'C'のみ
    question: 'string', // 問題文
    answer: 'string' // 解答。{{}}マーカー使用可
  }
],
```

### 4. 事案ストーリー（必須）
```javascript
story: [
  { type: 'scene', text: 'string' },
  { type: 'narration', text: 'string' },
  { type: 'dialogue', speaker: 'string', expression: 'string', dialogue: 'string' },
  { type: 'embed', format: 'string', title: 'string', description: 'string', content: 'string' }
],
```

### 5. 判旨と解説（必須）
```javascript
explanation: `HTMLstring`, // バッククォート禁止
```

### 6. ミニ論文問題（必須）
```javascript
quiz: [
  {
    title: "string",//絶対に「大問」とか「問」はつけない
    rank: "string", // "S", "A", "B", "C"
    background: `string`, // 事案背景
    subProblems: [
      {
        title: "string", //絶対に「小問」とか「問」はつけない
        rank: "string",
        relatedQAs: [array], // 数値配列
        problem: "string",
        hint: "string",
        points: ["array"], // 文字列配列
        modelAnswer: "string"
      }
    ]
  }
],
```

### 7. 論文トレーニング（廃止）
```javascript
essay: null // 必ずnullを設定
```

## 🎨 embed要素の作成ガイド

### 基本構造
```javascript
{
  type: 'embed',
  format: 'svg'|'html'|'css'|'math'|'mermaid', // 形式指定
  title: 'タイトル文字列',
  description: '説明文字列',
  content: 'HTMLまたはSVGまたはMermaidコンテンツ'
}
```

### Mermaid図表の作成（★重要★）

**� Mermaidフローチャート例は、実際のプロジェクトでは法的内容に応じて自由にカスタマイズしてください。**

```javascript
{
  type: 'embed',
  format: 'mermaid',
  title: '法的判断フローチャート（例）',
  description: '契約締結の判断プロセス（このデザインは自由に変更可能）',
  content: `flowchart LR
    START([📋 契約書案を受領]) --> CHECK{内容確認}
    CHECK -->|適切| NEGOTIATE[🤝 条件交渉]
    CHECK -->|問題あり| REVISE[📝 修正要求]
    REVISE --> CHECK
    NEGOTIATE --> DECIDE{最終判断}
    DECIDE -->|合意| SIGN[✅ 契約締結]
    DECIDE -->|不合意| BREAK[❌ 交渉終了]
    
    classDef process fill:#dbeafe,stroke:#3b82f6,stroke-width:2px
    classDef decision fill:#fef3c7,stroke:#f59e0b,stroke-width:2px
    classDef result fill:#d1fae5,stroke:#10b981,stroke-width:2px
    classDef termination fill:#fee2e2,stroke:#ef4444,stroke-width:2px
    
    class START,NEGOTIATE,REVISE process
    class CHECK,DECIDE decision
    class SIGN result
    class BREAK termination`
}
```

**🚨 Mermaid記法の絶対的ルール（構文エラー撲滅）:**

**A. ノードラベル内の禁止事項（最重要）**
- **❌ 絶対禁止**: `<br/>` `<br>` 等のHTMLタグをノードラベル内に使用
- **❌ 絶対禁止**: `<>` `{}` `[]` 等の特殊記号をラベル内に使用
- **❌ 絶対禁止**: 改行文字 `\n` をノードラベル内に使用
- **✅ 正しい方法**: 日本語カッコ（）で代用、または空白で区切る
- **例**: `F((行為の繰り返し<br/>Performativity))` → `F["行為の繰り返し（Performativity）"]`

**B. class文でのノード参照エラー対策（重要）**
- **❌ 絶対禁止**: `class ユズヒコ(買主),出品者(売主) party` （括弧を含むノード名はclass文で使用不可）
- **✅ 正しい方法**: ノードIDと表示テキストを分離

**C. subgraph名の日本語・特殊文字対策**
- **❌ 危険**: `subgraph 売買契約（【民法555条】）` （引用符なし）
- **✅ 正しい**: `subgraph "売買契約（【民法555条】）"` （引用符必須）

**D. classDef予約語エラー対策**
- **❌ 絶対禁止**: `classDef end` （endは予約語）
- **✅ 回避方法**: `classDef finish` または `classDef complete` を使用

**E. 矢印記法の統一化**
- **✅ 標準記法**: `-->` `-.->` `==>` のみ使用

**F. ノード形状の厳格な制限**
- **✅ 有効な形状のみ**:
  - 四角形: `A[テキスト]`
  - 菱形: `B{テキスト？}`
  - 円形: `C((テキスト))`
  - 六角形: `D{{テキスト}}`
  - 台形: `E[/テキスト/]` または `F[\テキスト\]`
  - 丸角四角形: `G([テキスト])`

**G. 必須開始構文（テンプレートリテラル）:**
- **必ず以下のいずれかで開始**: テンプレートリテラル `\`flowchart TD\`` または `\`graph TD\`` または `\`graph LR\``

**H. 債権債務関係図の正しい記法:**
- **債権者から債務者へ矢印**: 矢印の向きは債権者→債務者
- **矢印ラベルは債権の内容**: `A -->|代金支払請求権| B` のように債権名を記載

**I. よくあるエラーと修正例:**
```
❌ 間違い: F((行為の繰り返し<br/>Performativity))
✅ 修正後: F["行為の繰り返し（Performativity）"]

❌ 間違い: A["概念<>構造"]
✅ 修正後: A["概念（構造）"]

❌ 間違い: B{判断？<choice>}
✅ 修正後: B["判断？（choice）"]
```

### HTML表の作成

```javascript
{
  type: 'embed',
  format: 'html',
  title: '条文比較表（例）',
  description: '民法と商法の契約不適合責任の比較',
  content: '<div style="background: #f8fafc; padding: 20px; border-radius: 8px;"><table style="width: 100%; border-collapse: collapse;"><thead><tr style="background: #3b82f6; color: white;"><th style="padding: 12px;">項目</th><th style="padding: 12px;">民法</th><th style="padding: 12px;">商法</th></tr></thead><tbody><tr><td style="padding: 10px; border: 1px solid #ddd;">検査義務</td><td style="padding: 10px; border: 1px solid #ddd;">なし</td><td style="padding: 10px; border: 1px solid #ddd;">遅滞なく（商法526条）</td></tr></tbody></table></div>'
}
```
// ✅ 完璧な例 - 契約交渉における責任判断（実戦対応版）
content: `flowchart TD
A[契約交渉] --> B{準備段階に成熟？}
B -->|YES| C{相手に正当な期待を与えた？}
B -->|NO| F[賠償責任なし]
C -->|YES| D{正当な理由なく交渉破棄？}
C -->|NO| F
D -->|YES| E[信頼利益の賠償責任あり]
D -->|NO| F

classDef process fill:#bbdefb,stroke:#1976d2,stroke-width:2px
classDef decision fill:#fff9c4,stroke:#f57f17,stroke-width:2px
classDef liability fill:#c8e6c9,stroke:#388e3c,stroke-width:2px
classDef noLiability fill:#ffcdd2,stroke:#d32f2f,stroke-width:2px

class A process
class B,C,D decision
class E liability
class F noLiability`

// ✅ 正しい債権債務関係図 - 売買契約（ノードID分離版）
content: `graph LR
subgraph "売買契約（【民法555条】）"
  A[ユズヒコ<br/>買主] -->|代金支払請求権| B[出品者<br/>売主]
  B -->|目的物引渡請求権| A
end

classDef party fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
class A,B party`

// ✅ 他人物売買の法律関係（修正版）
content: `graph LR
A[買主] ---|売買契約【有効】| B[売主]
B -.->|権利移転義務| A
subgraph "真の権利者"
  C[所有権]
end
B -->|義務を履行するため| C

classDef party fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
classDef owner fill:#e8f5e9,stroke:#388e3c,stroke-width:2px
class A,B party
class C owner`

// ✅ シンプルな例 - 基本的な流れ
content: `graph TD
A[開始] --> B[処理]
B --> C[終了]`

// ✅ 横長推奨例
content: `graph LR
A[申立て] --> B[審理] --> C[判決] --> D[確定]`
```

**6. 絶対に避けるべき間違い（実戦エラー対策版）:**
- ❌ 一行記法は絶対禁止: `flowchart TD A[契約交渉] --> B{準備段階に成熟？} B -- YES --> C{相手に契約成立の正当な期待を与えた？}`
- ❌ エスケープ文字使用: `'flowchart TD\\nA[...]'` （旧構文）
- ❌ 無効なノード形状: `D[(レアカード)]` `E[[テキスト]]` `F[//テキスト//]` （STADIUMENDエラーの原因）
- ❌ class文でのノード名エラー: `class ユズヒコ(買主),出品者(売主) party` （括弧を含む名前は禁止）
- ❌ subgraph名に引用符なし: `subgraph 日本語テキスト` （引用符必須）
- ❌ 予約語を使用: `classDef end` `classDef start` （予約語は使用禁止）
- ❌ 古い矢印記法: `--›` `-->>` （`-->`のみ使用）
- ❌ 債権債務関係図で義務を矢印に記載: `買主 -->|代金支払義務| 売主` （正しくは「代金支払請求権」）
- ❌ 債権債務関係図で矢印の向きが逆: 債権者から債務者への矢印でなければならない

**8. 債権債務関係図の重要原則（強化版）:**
- **矢印の向き**: 債権者 → 債務者（権利の方向）
- **矢印のラベル**: 債権の名称（例：「代金支払請求権」「商品引渡請求権」）
- **間違い例**: 「○○義務」ではなく「○○請求権」を使用
- **ノードIDと表示テキストの分離**: 複雑な名前はclass文でエラーを起こすため、シンプルなIDを使用

**9. ノード命名のベストプラクティス（新規追加）:**
- **シンプルなID**: `A`, `B`, `C` または `start`, `process1`, `decision1`
- **表示テキストの改行**: `A[長いテキスト<br/>改行部分]`
- **日本語対応**: 日本語ノード名も可能だが、class文では英数字IDを推奨
- **✅推奨パターン**:
```javascript
// パターン1: 英数字ID + 日本語表示
A[契約締結] --> B[有効性判断]

// パターン2: 日本語ID（シンプルな場合のみ）
契約 --> 判断 --> 結果

// パターン3: 改行を含む表示（推奨）
A[契約不適合<br/>発覚] --> B{追完請求<br/>可能？}
```

**10. subgraphとclassDefの詳細ルール:**
- **subgraph名**: 必ず引用符で囲む `subgraph "名前"`
- **classDef名**: 予約語を避ける（end, start, if, else等）
- **推奨classDef名**: `process`, `decision`, `result`, `error`, `success`, `finish`
- **色指定**: 16進数カラーコードまたはCSS色名を使用

**11. エラー診断チェックリスト（必須確認項目）:**
□ テンプレートリテラル（バッククォート）を使用している
□ 開始行は`flowchart TD`または`graph LR`のみ
□ ノード定義と接続が別々の行にある
□ 無効なノード形状（`[(`, `[[`, `[//`）を使用していない
□ class文でシンプルなノードIDを使用している
□ subgraph名を引用符で囲んでいる
□ classDef名に予約語を使用していない
□ 矢印記法が`-->`で統一されている
□ 債権関係図で矢印の向きが正しい（債権者→債務者）
- ❌ セミコロン使用: `A[開始];` 
- ❌ 文字列の間違い: `'flowchart TD'` + 追加文字列

**6. 特殊文字の使用:**
- ❌ 開始行にノード定義を含める
- ❌ 複数の接続を一行にまとめる
- ❌ 物理的な改行を使用する

**6. その他の重要ルール:**
- **文字列内に余計な引用符やエスケープを使わない**
- **ノードラベルは簡潔に**（長すぎる場合は自動短縮）
- **日本語の中黒「・」は避け、代わりに「•」を使用**
- **疑問符「？」は判断ノードのラベルに積極的に使用**

**7. 🏛️ 債権関係図の矢印ルール（民法・商法分野専用）:**
- **債権者→債務者の方向（必須）**: 債権は債権者が債務者に対して有する権利なので、矢印は必ず債権者から債務者に向けて描く
  - ✅ 正しい例: `債権者 -->|売買代金支払請求権| 債務者`
  - ❌ 間違い例: `債務者 -->|売買代金支払義務| 債権者`（義務の矢印は逆向きなので使用禁止）
- **主債権（実線矢印）**: `債権者 -->|債権内容| 債務者` の形式で債権の具体的内容を記載
  - 例: `被害者 -->|不法行為に基づく損害賠償請求権| 加害者`
  - 例: `買主 -->|売買契約に基づく引渡請求権| 売主`
  - 例: `売主 -->|売買契約に基づく代金支払請求権| 買主`
  - 例: `貸主 -->|消費貸借契約に基づく返還請求権| 借主`
  - 例: `賃貸人 -->|賃貸借契約に基づく賃料支払請求権| 賃借人`
- **付従的債権（点線矢印）**: `主債権者 -.->|保証債権等| 保証人` の形式で付従的な性質を表現
  - 例: `主債権者 -.->|保証債権| 保証人`
  - 例: `主債権者 -.->|物上保証債権| 物上保証人`
  - 例: `主債権者 -.->|連帯保証債権| 連帯保証人`
- **求償権（細実線）**: 保証人から主債務者への権利を表現
  - 例: `保証人 -->|求償権| 主債務者`
  - 例: `連帯保証人 -->|求償権| 主債務者`
- **担保関係（太実線）**: `債権者 ==>|担保権| 担保物件` の形式で担保物権を表現
  - 例: `債権者 ==>|抵当権| 不動産`
  - 例: `債権者 ==>|質権| 動産•債権`
  - 例: `債権者 ==>|留置権| 物件`

**Mermaid図表の種類（自由選択・カスタマイズ推奨）:**
- `graph TD` (上から下のフローチャート)
- `graph LR` (左から右のフローチャート) ★横長推奨★  
- `flowchart TD` (詳細フローチャート)
- `gitgraph` (Git流れ図)
- `pie` (円グラフ)
- `gantt` (ガントチャート)

**★横長フローチャート推奨理由:**
- 画面幅を有効活用し、見やすさが向上
- 法的な流れや因果関係を自然に表現
- スマートフォンでも読みやすい
- 複雑な関係性をコンパクトに整理可能

**🎯 Mermaidフローチャートの効果的な活用方法（完全自由設計）:**
1. **ストーリーの合間に挿入**: 複雑な法的関係を視覚的に整理
2. **論点ごとに分割**: 大きな問題を小さな図表に分けて理解しやすく
3. **判断フローの明示**: 「もし〜なら」の分岐構造を明確に表現
4. **時系列の表現**: 事案の流れや手続きの順序を図示
5. **★表との併用推奨**: 複雑なデータは表、関係性はフローチャートで使い分け
6. **🏛️ 債権関係の可視化**: 主債権と付従的債権を矢印で明確に区別（必ず債権者→債務者の方向）
   - 実線矢印: 主たる債権（売買、賃貸借、不法行為等） - 債権者から債務者へ
   - 点線矢印: 付従的債権（保証、物上保証等） - 主債権者から保証人へ
   - 太実線矢印: 担保物権（抵当権、質権等） - 債権者から担保物件へ
   - 求償権: 保証人から主債務者への実線矢印
7. **🎨 視覚デザインの自由度**: 色、形状、サイズ、レイアウトは法的内容に応じて完全にカスタマイズ可能
8. **📱 レスポンシブ対応**: 横長レイアウト（graph LR）で各デバイスに最適化
9. **🔤 絵文字・アイコン活用**: ⚖️、📋、🤝、✅、❌、🏛️ など視認性向上に自由使用

**💡 創作時の自由度**: 
- **完全カスタマイズ可**: 図表の種類、色彩、レイアウト、矢印の種類、ノードの形状など全て自由に設計
- **法分野適応**: 憲法、民法、刑法、商法など分野に応じて最適なデザインを選択
- **学習者配慮**: 複雑さのレベルを学習者に合わせて調整可能

**Mermaid使用例（完全修正版）:**
```javascript
// ✅ 判断フローチャート（推奨・カラフル版）
content: `flowchart TD
A[契約締結] --> B[有効性の判断]
B -->|有効| C[履行請求可能]
B -->|無効| D[原状回復]
C --> E[損害賠償請求]
D --> F[不当利得返還]

classDef process fill:#bbdefb,stroke:#1976d2,stroke-width:2px
classDef decision fill:#fff9c4,stroke:#f57f17,stroke-width:2px
classDef valid fill:#c8e6c9,stroke:#388e3c,stroke-width:2px
classDef invalid fill:#ffcdd2,stroke:#d32f2f,stroke-width:2px

class A process
class B decision
class C,E valid
class D,F invalid`

// ✅ 人物相関図（シンプル記法）
content: `graph TD
A[みかん] --> B[岩城くん]
A --> C[しみちゃん]
D[ユズヒコ] --> E[藤野]`

// ✅ 法的手続きの流れ
content: `flowchart TD
A[申立て] --> B[受理]
B --> C[審理]
C --> D[判断]
D --> E[決定•命令]`

// ✅ 権利関係の整理（横長推奨・債権者→債務者方向）
content: `graph LR
債権者 -->|主債権| 債務者
債権者 -.->|保証債権| 保証人
債権者 ==>|担保権| 担保物件`

// ✅ より詳細なフローチャート例（カラフル版）
content: `flowchart TD
A[代理行為] --> B{代理権の存在？}
B -->|有| C[顕名の有無を確認]
B -->|無| D[無権代理]
C --> E[有権代理成立]
C --> F[隠れた代理]
D --> G{表見代理の成立？}
G -->|成立| H[本人に効果帰属]
G -->|不成立| I[無権代理人の責任]

classDef startNode fill:#e1f5fe,stroke:#0288d1,stroke-width:2px
classDef decisionNode fill:#fff3e0,stroke:#f57c00,stroke-width:2px
classDef validNode fill:#e8f5e8,stroke:#388e3c,stroke-width:2px
classDef invalidNode fill:#ffebee,stroke:#d32f2f,stroke-width:2px

class A startNode
class B,G decisionNode
class C,E,H validNode
class D,F,I invalidNode`

// ✅ 複雑な法的判断フローの例
content: `flowchart TD
A[契約交渉開始] --> B{準備段階に成熟？}
B -->|YES| C{相手に正当な期待を与えた？}
B -->|NO| F[賠償責任なし]
C -->|YES| D{正当な理由なく交渉破棄？}
C -->|NO| F
D -->|YES| E[信頼利益の賠償責任あり]
D -->|NO| F`

// ✅ 債権関係図の例（矢印の使い分け - 債権者→債務者方向徹底）
content: `graph LR
被害者 -->|不法行為に基づく損害賠償請求権| 加害者
被害者 -.->|保証債権| 保証人
被害者 -.->|物上保証債権| 物上保証人
被害者 ==>|抵当権| 担保不動産`

// ✅ 売買契約の債権関係図（双務契約の正しい表現）
content: `graph LR
買主 -->|売買契約に基づく引渡請求権| 売主
売主 -->|売買契約に基づく代金支払請求権| 買主
売主 -.->|連帯保証債権| 連帯保証人
売主 ==>|質権| 担保物件`

// ✅ 複雑な債権関係の整理（求償権も債権者→債務者方向）
content: `flowchart TD
主債権者 -->|消費貸借契約に基づく返還請求権| 主債務者
主債権者 -.->|保証債権| 保証人
主債権者 -.->|連帯保証債権| 連帯保証人
主債権者 ==>|抵当権| 不動産
主債権者 ==>|質権| 動産
保証人 -->|求償権| 主債務者
連帯保証人 -->|求償権| 主債務者`
```

**❌ 絶対に使ってはいけない間違った記法例:**
```javascript
// ❌ 致命的エラー例 - 一行記法は絶対禁止
content: `flowchart TD A[契約交渉] --> B{準備段階に成熟？} B -- YES --> C{相手に契約成立の正当な期待を与えた？} C -- YES --> D{正当な理由なく交渉を破棄した？} D -- YES --> E[信頼利益の賠償責任あり] B -- NO --> F[賠償責任なし] C -- NO --> F D -- NO --> F`

// ❌ この書き方も構文エラーになる（一行記法）
content: `graph TD A --> B{質問？} B -- YES --> C B -- NO --> D`

// ❌ 旧構文エスケープ文字使用（現在は禁止）
content: 'flowchart TD\\nA[開始] --> B[終了]'
```

**⚠️ 構文エラー時の自動対応:**
- 不完全な矢印記法は自動で `-->` に修正
- 閉じ括弧のないラベルは自動で補完
- 長すぎるラベルは30文字で自動短縮
- 日本語特殊文字は自動でエスケープ
- エラー発生時には修正案が表示される

**ズーム機能対応済み:**
- 全てのMermaidフローチャートには自動的にズーム機能が追加されます
- 「拡大」「縮小」「リセット」ボタンでサイズ調整可能
- マウスホイールでのズーム操作に対応
- ドラッグでの画面移動（パン）に対応
- 複雑な図表も詳細まで確認可能

**🔧 自動修正機能搭載:**
- 構文エラーは自動検出・修正される
- エラー時には詳細な修正案が表示
- ワンクリックで修正案を適用可能
- 不完全な記法も自動で補完される


### HTML表の作成

> **💡 注意**: 以下の表の例は単なるサンプルです。実際の創作時には、法分野や内容に応じて表のデザイン、色、項目、レイアウトなどを自由に変更・調整してください。

```javascript
{
  type: 'embed',
  format: 'html',
  title: '条文比較表（例）',
  description: '民法と商法の契約不適合責任の比較（このデザインは自由に変更可能）',
  content: '<div style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); padding: 24px; border-radius: 12px; margin: 20px 0; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);"><table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);"><thead><tr style="background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color: white;"><th style="padding: 16px; text-align: left; font-weight: bold; border-bottom: 2px solid #1e40af;">項目</th><th style="padding: 16px; text-align: left; font-weight: bold; border-bottom: 2px solid #1e40af;">民法（売買契約）</th><th style="padding: 16px; text-align: left; font-weight: bold; border-bottom: 2px solid #1e40af;">商法（商事売買）</th></tr></thead><tbody><tr style="background: #f8fafc;"><td style="padding: 14px; border-bottom: 1px solid #e2e8f0; font-weight: 600; color: #374151;">🔍 検査義務</td><td style="padding: 14px; border-bottom: 1px solid #e2e8f0; color: #4b5563;">なし</td><td style="padding: 14px; border-bottom: 1px solid #e2e8f0; color: #4b5563;"><span style="background: #fef3c7; padding: 4px 8px; border-radius: 4px; color: #92400e; font-weight: 500;">遅滞なく検査義務（商法526条）</span></td></tr><tr style="background: white;"><td style="padding: 14px; border-bottom: 1px solid #e2e8f0; font-weight: 600; color: #374151;">⏰ 通知期間</td><td style="padding: 14px; border-bottom: 1px solid #e2e8f0; color: #4b5563;"><span style="background: #dcfce7; padding: 4px 8px; border-radius: 4px; color: #166534; font-weight: 500;">1年間（民法566条）</span></td><td style="padding: 14px; border-bottom: 1px solid #e2e8f0; color: #4b5563;"><span style="background: #fee2e2; padding: 4px 8px; border-radius: 4px; color: #dc2626; font-weight: 500;">6か月（商法526条2項）</span></td></tr><tr style="background: #f8fafc;"><td style="padding: 14px; border-bottom: 1px solid #e2e8f0; font-weight: 600; color: #374151;">📋 適用範囲</td><td style="padding: 14px; border-bottom: 1px solid #e2e8f0; color: #4b5563;">一般の売買契約</td><td style="padding: 14px; border-bottom: 1px solid #e2e8f0; color: #4b5563;">商人間の売買</td></tr><tr style="background: white;"><td style="padding: 14px; font-weight: 600; color: #374151;">⚖️ 法的効果</td><td style="padding: 14px; color: #4b5563;">解除・代金減額・損害賠償</td><td style="padding: 14px; color: #4b5563;">同左（ただし期間制限厳格）</td></tr></tbody></table><div style="margin-top: 16px; padding: 12px; background: #f1f5f9; border-left: 4px solid #3b82f6; border-radius: 4px;"><p style="margin: 0; font-size: 13px; color: #475569; line-height: 1.5;"><strong style="color: #1e40af;">💡 ポイント:</strong> 商法は迅速な商取引を前提とするため、民法よりも厳格な期間制限を設けている</p></div></div>'
}
```

**🎨 表のスタイリング例（カスタマイズ自由）:**

```javascript
// 📊 シンプルなボーダー表（基本形）
content: '<div style="background: #ffffff; padding: 20px; border-radius: 8px; margin: 16px 0; border: 2px solid #e5e7eb;"><table style="width: 100%; border-collapse: collapse;"><thead><tr style="background: #f3f4f6;"><th style="padding: 12px; text-align: left; border: 1px solid #d1d5db; font-weight: bold; color: #374151;">項目</th><th style="padding: 12px; text-align: left; border: 1px solid #d1d5db; font-weight: bold; color: #374151;">内容</th></tr></thead><tbody><tr><td style="padding: 10px; border: 1px solid #d1d5db;">例1</td><td style="padding: 10px; border: 1px solid #d1d5db;">説明1</td></tr><tr style="background: #f9fafb;"><td style="padding: 10px; border: 1px solid #d1d5db;">例2</td><td style="padding: 10px; border: 1px solid #d1d5db;">説明2</td></tr></tbody></table></div>'

// 🌈 カラフルな比較表（色分け重視）
content: '<div style="background: linear-gradient(45deg, #fef7cd 0%, #fef3c7 100%); padding: 24px; border-radius: 16px; margin: 20px 0; border: 3px solid #f59e0b;"><table style="width: 100%; border-collapse: collapse; background: white; border-radius: 12px; overflow: hidden;"><thead><tr style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white;"><th style="padding: 16px; text-align: center; font-weight: bold;">🏛️ 憲法</th><th style="padding: 16px; text-align: center; font-weight: bold;">📜 民法</th><th style="padding: 16px; text-align: center; font-weight: bold;">⚖️ 刑法</th></tr></thead><tbody><tr><td style="padding: 14px; text-align: center; background: #fef3c7; border-right: 1px solid #f59e0b;">基本的人権</td><td style="padding: 14px; text-align: center; background: #ecfdf5; border-right: 1px solid #10b981;">私的自治</td><td style="padding: 14px; text-align: center; background: #fef2f2;">罪刑法定主義</td></tr></tbody></table></div>'

// 📋 データ整理表（情報整理重視）
content: '<div style="background: #f8fafc; padding: 20px; border-radius: 10px; margin: 16px 0; border-left: 6px solid #3b82f6;"><table style="width: 100%; border-collapse: collapse; background: white; box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);"><caption style="padding: 10px; font-weight: bold; color: #1e40af; text-align: left;">判例整理表</caption><thead><tr style="background: #3b82f6; color: white;"><th style="padding: 12px; text-align: left;">事件名</th><th style="padding: 12px; text-align: left;">年月日</th><th style="padding: 12px; text-align: left;">要旨</th></tr></thead><tbody><tr style="border-bottom: 1px solid #e5e7eb;"><td style="padding: 10px;">例判決</td><td style="padding: 10px;">令和○年○月○日</td><td style="padding: 10px;">重要な法理を確立</td></tr></tbody></table></div>'
```

## 👥 キャラクター仕様

### 利用可能キャラクター（完全版）

**◆ タチバナ家（家族）**
- **母**: タチバナ家の主婦。九州・大分県出身。極端な倹約家だが、自分の好きな物にはお金を惜しまない。体脂肪率51%で、時に火を吹くなど超人的な能力を見せる。世間体を気にする内弁慶だが、困っている人は放っておけない情に厚い一面も。口癖は「情熱の赤いバラ」の鼻歌と「〜してちょうだいっ」。みかんを「みかん」、ユズヒコを「ユズ」「ユーちゃん」、父を「あなた」と呼ぶ。主にタチバナ家に登場。
- **みかん**: タチバナ家の長女で本作の語り手。身長155cm、17歳（高校2年生）。平凡で夢見がちな性格。手芸が得意で「ベア研」に所属。岩城を「岩城くん」と呼び片思い中。岩城くんを見るとドキドキして、話すときは挙動不審になる。親友はしみちゃん。大雑把で面倒くさがりな面は母親譲り。司法試験予備試験の受験生。ユズヒコを「ユズ」「ユズヒコ」、母を「お母さん」、父を「お父さん」と呼ぶ。主にタチバナ家、みかんの高校に登場。
- **ユズヒコ**: タチバナ家の長男。友人からは「ユズピ」と呼ばれる、14歳（中学2年生）。シャイで繊細な性格で、家族の中では最も常識人。母や姉の無神経な言動にいつも振り回されている苦労人。クラスの女子にモテるが本人は無自覚。アイドルの丸野丸美の隠れファン。法律知識が豊富で、姉に的確なアドバイスをする。口癖は呆れた時。みかんを「姉ちゃん」と呼ぶ。主にタチバナ家、ユズヒコの中学校に登場。
- **父**: タチバナ家の大黒柱。九州・大分県出身のサラリーマン、40代後半。極端に無口でマイペース。「知らん」「はっは」が口癖。酔っぱらうと不要な物を捨てる「捨て魔」に豹変する。トイレのドアを開けたまま用を足すなど、他人の目を全く気にしないが、いざという時には頼りになる存在。みかんを「みかん」、ユズヒコを「ユズ」と呼ぶ。主にタチバナ家に登場。

**◆ みかんの高校の友人・関係者**
- **しみちゃん**: みかんの大親友、17歳。本名は清水。刑事訴訟法のスペシャリスト。常に冷静沈着で、どこか達観した大人びた雰囲気を持つ。**非常にサバサバした性格**で、感情的になることは稀。みかんの最大の理解者であり、彼女の恋や悩みの相談に乗ることが多い。タロット占いが得意で、しばしば核心を突く鋭い一言を放つ。「男には懲りた」が口癖。**ベア研との関係**: ベア研メンバーとのかかわりはほとんどない。みかんを「みかん」と呼ぶ。主にみかんの高校に登場。
- **吉岡**: みかんの高校のクラスメート、17歳。南中学校からの同級生。会社法に詳しい。みかんのことは「タチバナ」と呼び捨てにする。気兼ねなく話せる友人で、みかんをからかうのが好き。岩城の親友。お調子者でクラスのムードメーカー的存在だが、時に深い思考を見せることもある。魚の顔を見るのが苦手。主にみかんの高校に登場。
- **ゆかりん**: みかんの友人で、本名は「ゆか」、17歳。刑法に詳しい。おっとりしていて普段は物静かだが、一度笑いのツボに入ると周りを気にせず大爆笑する。みかんの発言に大ウケすることが多い。おまんじゅうのように丸い顔立ちが特徴。手先が器用で編み物が得意。**話し方ルール**: 「～わね」「のよ」「しているのね」「したのよ」は使用禁止、代わりに「～ね」「～よ」「しているね」「したよ」を使用する。**ベア研との関係**: ベア研メンバーとのかかわりはほとんどない。みかんを「みかん」と呼ぶ。主にみかんの高校に登場。
- **岩城**: みかんの高校のクラスメートで、彼女の片思いの相手、17歳。商法が得意。みかんのことは、少し距離を置きつつも敬意を込めて「タチバナさん」と呼ぶ。物腰が柔らかく、誰にでも優しい好青年だが同級生には敬語を使わない、ため口。独特の落ち着いた雰囲気を持ち、女子からの人気も高い。みかんの気持ちには気づいていない様子。絶叫マシンが苦手。4歳下の弟がいる。主にみかんの高校に登場。
- **春山ふぶき**: みかんの高校のクラスメート、17歳。著作権法に詳しい。おっとりしたお嬢様タイプの美少女だが、極度の天然ボケで、他人の親切を悪気なく無にするため「要注意人物」として知られている。「ごめ～ん」や「そ～なの～」みたいなしゃべり方をする。男子に人気がある。主にみかんの高校に登場。
- **ミエ**: みかんの高校のクラスメート、17歳。特許法に詳しい。理系志向で論理的思考が得意。発明や技術に関する話題になると目を輝かせる。普段はクールで落ち着いているが、知的財産の話になると熱くなる。将来は弁理士を目指している。みかんを「みかん」と呼ぶ。主にみかんの高校に登場。
- **宮嶋先生**: みかんの高校の古文教師。元検察官で刑事実務に精通している。白髪頭のベテラン。授業中に雑談を始めることが多く、全ての失敗を二度繰り返すという持論を持つ。『SLAM DUNK』全巻を所有。みかんの高校に登場。
- **ひとみ先生**: みかんの高校の数学教師。かつて麻雀の腕前から「雀鬼」と呼ばれていたが、いつの間にか「牛鬼」というあだ名に変化した。みかんの高校に登場。

**◆ ベア研（みかんの高校）**
- **理央**: みかんの高校のベア研メンバー、17歳。行政事件訴訟法に詳しい。細い目が特徴で、実家はお金持ち。おっとりとしたお嬢様タイプの性格だが、テディベア作りのことになると夢中になる。ブランド志向の母親に少し呆れている。**話し方**: 上品だが「～わよ」「～のよ」などの古風な言葉遣いは使わない。普通の女子高生らしい話し方。みかんを「みかん」と呼ぶ。同級生にはタメ口。主にみかんの高校のベア研部室に登場。
- **浅田**: みかんの高校のベア研メンバーで、後に部長になる、17歳。行政手続法に詳しい。ぽっちゃりした体型が特徴。真面目で責任感が強く、約束の時間は必ず守るしっかり者。普段は温厚だが、怒ると非常に怖い。**話し方**: しっかりしているが「～わよ」「～のよ」などの古風な言葉遣いは使わない。普通の女子高生らしい話し方。みかんを「みかん」と呼ぶ。同級生にはタメ口。主にみかんの高校のベア研部室に登場。
- **梶井**: みかんの高校のベア研メンバー、17歳。行政不服審査法に詳しい。ぱっちりとした大きな目が特徴。ベア研の中では比較的常識的で、冷静なツッコミ役。**話し方**: クールで冷静だが「～わよ」「～のよ」などの古風な言葉遣いは使わない。普通の女子高生らしい話し方。みかんを「みかん」と呼ぶ。同級生にはタメ口。主にみかんの高校のベア研部室に登場。
- **新田**: みかんの高校のベア研メンバーで、1年後輩、16歳。国家賠償法に詳しい。口癖は「～っス」。明るく素直な性格。高田くんという彼氏がおりラブラブ。みかんを「みかん先輩」と呼ぶ。先輩には敬語を使う。主にみかんの高校のベア研部室に登場。

**◆ ユズヒコの中学校の友人・関係者**
- **藤野**: ユズヒコの親友、14歳。民法総則に詳しい。野球部所属。3人兄弟の長男で、2人の弟がいる。両親が共働きで忙しいため、しっかり者の面もある。姉のいるユズヒコを羨ましがっている。思ったことがすぐ口に出る「思考だだもれ男」。後に須藤に好意を寄せる。ユズヒコを「ユズピ」と呼ぶ。同級生にはタメ口。主にユズヒコの中学校に登場。
- **ナスオ**: ユズヒコの友人、14歳。本名は那須野。物権法に詳しい。ナスのような顔の形が特徴。常にテンションが高く、サッカー部所属。ユズヒコと同じく丸野丸美のファン。他人の話を自己流に解釈して噂を広めるトラブルメーカーな一面も。標準語で話す。ユズヒコを「ユズピ」と呼ぶ。主にユズヒコの中学校に登場。
- **石田**: ユズヒコのクラスメート、14歳。債権各論が得意。女子。食べ物の匂いを嗅いだり、カーテンで手を拭いたりするなど、常人には理解しがたい奇妙な行動をとるが、本人なりの合理的な理由がある。一人称は私。石田は須藤と仲が良く「スドー」と呼び捨てにする。独特の感性を持つ少女。ユズヒコを「ユズピ」と呼ぶ。主にユズヒコの中学校に登場。
- **山下**: ユズヒコのクラスメートで、川島の親友の女子、14歳。民事訴訟法が得意。川島と共に「ユズヒコファンクラブ」を結成し、彼女の恋を応援している。冷静なツッコミ役だが、川島の情熱に巻き込まれがち。ユズヒコを「タチバナくん」と呼ぶ。主にユズヒコの中学校に登場。川島との間ではユズヒコを「ユズピ」と呼ぶ
- **川島**: ユズヒコのクラスメート、14歳。ユズヒコと婚姻する妄想の結果、親族・相続法にドはまり中。プールでの出来事をきっかけにユズヒコに熱烈な片思いをする。しかし、ユズヒコが好きなことをユズヒコの前でばらすことはなく、めちゃくちゃ恥ずかしがる。山下と話すときは、ユズヒコのかっこよさを永遠と狂ったほどに話す。親友の山下と「ユズヒコファンクラブ」を結成。恋に一途で情熱的だが、思い込みが激しく行動は空回りしがち。ユズヒコを「タチバナくん」と呼ぶ。主にユズヒコの中学校に登場。山下との間ではユズヒコを「ユズピ」と呼ぶ
- **須藤**: ユズヒコのクラスメート。女子、14歳。債権総論が得意。真面目で成績優秀。自分の考えをはっきりと主張できるしっかり者。めちゃくちゃ性格がよい。孤立していた石田の良き理解者。藤野から好意を寄せられている。ユズヒコを「タチバナくん」と呼ぶ。同級生に対してはタメ口で話す。主にユズヒコの中学校に登場。
- **原先生**: ユズヒコの中学の担任教師。通称「ハラセン」。国語担当。元裁判官で民事実務に精通している。ギラギラした目つきとダミ声が特徴で、生徒から恐れられている。給食の食べ残しを許さないなど非常に厳しいが、事なかれ主義な一面も。ユズヒコの中学校に登場。【セリフ例】給食、残さず食べる。これ常識。　君たち何をしている。

**◆ その他のキャラクター**
- **水島さん**: 母の親友、45歳。憲法（人権）に詳しい。三角の目が特徴。多趣味で行動的。「思い立ったが吉日」が信条で、母を様々な活動に誘う。流行にも敏感で世渡り上手。高校生の息子・純がいる。タチバナ家の近隣。
- **戸山さん**: 母の親友。憲法（総論）に詳しい。眼鏡をかけており、上品で落ち着いた雰囲気。大らかで親しみやすい人柄。運転免許を持っており、3人で出かける際のドライバー役。手先が器用で陶芸が得意。タチバナ家の近隣。
- **三角さん**: 母の友人。憲法（統治）に詳しい。夫が開業医で裕福な主婦。母たちと「マダム・デ・ジュネ」という会を開いている。グループの中では最も常識人だが、庶民的な友人たちの言動に興味を示している。タチバナ家の近隣。
- **越野あん**: タチバナ家の隣に住む漫画家。夫と娘のりんちゃんと3人暮らし。武道漫画を執筆している。吉祥寺の井の頭公園で恋人と別れた経験から、吉祥寺が苦手。タチバナ家の隣。


### expression（表情）オプション
- **normal**: 通常
- **impressed**: 感心
- **angry**: 怒り
- **surprised**: 驚き
- **happy**: 嬉しい
- **sad**: 悲しい
- **thinking**: 考え中
- **laughing**: 笑い
- **desperate**: 絶望
- **smug**: 得意げ
- **annoyed**: イライラ
- **blush**: 照れ
- **cool**: クール
- **serious**: 真剣
- **excited**: 興奮
- **passionate**: 熱血

### 重要な場所設定ルール
- **タチバナ家**: 基本的に家族のみ登場
- **みかんの高校**: 高校生キャラクターが登場
- **ベア研部室**: ベア研メンバーとみかんが中心
- **ユズヒコの中学校**: 中学生キャラクターが登場

### キャラクター間の重要な関係性
- **みかん→岩城**: 片思い中
- **川島→ユズヒコ**: 熱烈な片思い中
- **藤野→須藤**: 好意を寄せている

## 🎯 コンテンツ作成の詳細ガイド

### ★重要★ Mermaidフローチャートの積極活用
法学分野では複雑な概念や手続きを視覚的に整理することが学習効果を大幅に向上させます。

**配置のコツ:**
- ストーリーの序盤で事案概要を図示
- 中盤で判断プロセスをフローチャートで説明
- 終盤で結論をまとめる相関図を配置
- 債権関係図では必ず「債権者 -->|債権内容| 債務者」の形式を守る

### ★最重要★ ストーリー作成の基本方針

**1. ストーリーの長さ（最重要）:**
- **めちゃくちゃ長く書く**ことが最も重要
- 最低でも15〜25個のstory要素を含める
- 詳細な対話、詳しい状況説明、複数のシーンを含む

**2. キャラクター選定方針:**
- **★最重要★ 得意分野を最優先**してキャラクター選定
- **みかんやユズヒコが必ず登場する必要はない**
- **専門性重視**: 扱う法分野の専門知識を持つキャラを中心に
- **バラエティ豊かなキャラクター**を起用
- **登場可能場所を厳守**

### knowledgeBox作成ルール
```javascript
knowledgeBox: `
  【判例・法令の正式名称】
  - **重要概念**: 定義と説明
  - **判断基準**: 具体的な基準【id:番号】
  - **条文番号**: 【法律名○条】形式で記載
  
  【事案の概要】
  - 事実関係の整理
  - 争点の明確化
  
  【判旨・解釈】
  - 裁判所の判断
  - 学説の対立
  
  【実務への影響】
  - 実際の適用場面
  - 注意点
`,
```

## ⚠️【超重要】条文参照ルールの強調

> **条文や法令名を文中で参照する場合は、必ず【】（全角カギカッコ）で囲むこと。**
> 
> 例：
> - 【民法709条】
> - 【刑法199条】
> - 【会社法3条】
> - 【会社法3条3号】
> 
> ※【】で囲まれていない条文参照は全て修正対象とする。

### ★重要★ 条文記述の統一ルール

**1. 基本的な条文記述:**
- **【法律名○条】**形式で統一

**2. 項・号の記述:**
- **【法律名○条○項】**：【民法424条の3第2項】
- **【法律名○条○号】**：【民法177条1号】
- **【法律名○条○項○号】**：【民法424条の3第2項1号】

**3. 特殊な条文記述:**
- **条の2、条の3など**：【民法424条の3】、【会社法356条の2】

**4. 複数条文の記述:**
- **連続する条文**：【民法90条〜92条】
- **複数の条文**：【民法90条・95条】

**5. 法令の略記ルール:**
- **民法** → 民法
- **刑法** → 刑法  
- **日本国憲法** → 憲法
- **会社法** → 会社法
- **民事訴訟法** → 民訴法
- **刑事訴訟法** → 刑訴法

### questionsAndAnswers作成ルール
{{}}の中に判例の年月日は入れない。内容に関する重要な部分をたくさん入れる。
```javascript
questionsAndAnswers: [
  { 
    id: 1, 
    rank: 'A', 
    question: '○○について説明しなさい。', 
    answer: '○○とは、{{重要部分}}である。理由は{{理由}}だからである。' 
  }
],
```

### story作成ルール
1. **scene**: 場面設定（必須）
2. **narration**: 状況説明
3. **dialogue**: キャラクター対話
4. **embed**: 図表挿入（★Mermaidフローチャート推奨★）

**★最重要★ ストーリーの詳細化要件:**
- **最低15〜25個のstory要素**を含む長大なストーリー
- 詳細な場面描写、キャラクター間の自然な対話を重視
- 法的問題を段階的に発見・検討する流れを丁寧に描写
- 複数のシーン転換を含む構成

### explanation作成ルール
```javascript
explanation: `
  <h3 class="text-xl font-bold mb-4">タイトル</h3>
  <p class="mb-4">導入文</p>
  
  <h4 class="text-lg font-bold mt-6 mb-2">小見出し</h4>
  <p class="mb-4">説明文</p>
  
  <ul class="list-disc list-inside mb-4 pl-4 space-y-2">
    <li><span class="text-red-600 font-bold">重要ポイント</span>：説明</li>
  </ul>
  
  <div class="bg-yellow-100 p-4 rounded-lg mt-6">
    <h5 class="font-bold text-yellow-800">司法試験ポイント</h5>
    <p>受験対策情報</p>
  </div>
`,
```

### quiz作成ルール
```javascript
quiz: [
  {
    title: "大問タイトル",
    rank: "S",
    background: `事案背景の詳細説明`,
    subProblems: [
      {
        title: "小問タイトル",
        rank: "A",
        relatedQAs: [1, 2, 3], // questionsAndAnswersのid参照
        problem: "具体的な問題文",
        hint: "解答のヒント",
        points: ["評価ポイント1", "評価ポイント2"],
        modelAnswer: "模範解答の詳細"
      }
    ]
  }
],
```

**★重要★ ミニ論文問題の登場人物設定:**
- **登場人物は必ずあたしンちキャラクターに変更**すること
- 法的内容や事案の現実性はそのまま維持
- 単に名前だけを置き換える

### explanation作成ルール
```javascript
explanation: `
  <h3 class="text-xl font-bold mb-4">タイトル</h3>
  <p class="mb-4">導入文</p>
  
  <h4 class="text-lg font-bold mt-6 mb-2">小見出し</h4>
  <p class="mb-4">説明文</p>
  
  <ul class="list-disc list-inside mb-4 pl-4 space-y-2">
    <li><span class="text-red-600 font-bold">重要ポイント</span>：説明</li>
  </ul>
  
  <div class="bg-yellow-100 p-4 rounded-lg mt-6">
    <h5 class="font-bold text-yellow-800">司法試験ポイント</h5>
    <p>受験対策情報</p>
  </div>
`,
```

**条文記述を含むexplanation例:**
```javascript
explanation: `
  <h3 class="text-xl font-bold mb-4">【民法90条】公序良俗違反</h3>
  <p class="mb-4">【民法90条】は「公の秩序又は善良の風俗に反する法律行為は、無効とする」と規定しています。</p>
  
  <h4 class="text-lg font-bold mt-6 mb-2">【民法424条の3第2項】との関係</h4>
  <p class="mb-4">詐害行為取消権における【民法424条の3第2項】の「相当の対価」要件は、【民法90条】の判断にも影響します。</p>
  
  <ul class="list-disc list-inside mb-4 pl-4 space-y-2">
    <li><span class="text-red-600 font-bold">【憲法14条】との関係</span>：公序良俗は憲法価値と密接に関連</li>
  </ul>
`,
```

### quiz作成ルール
```javascript
quiz: [
  {
    title: "大問タイトル",
    rank: "S",
    background: `事案背景の詳細説明`,
    subProblems: [
      {
        title: "小問タイトル",
        rank: "A",
        relatedQAs: [1, 2, 3], // questionsAndAnswersのid参照　
        problem: "具体的な問題文",
        hint: "解答のヒント",
        points: ["評価ポイント1", "評価ポイント2"],
        modelAnswer: "模範解答の詳細"
      },
      {
        title: "小問タイトル",
        rank: "B",
        relatedQAs: [4,5,6], // questionsAndAnswersのid参照
        problem: "具体的な問題文",
        hint: "解答のヒント",
        points: ["評価ポイント1", "評価ポイント2"],
        modelAnswer: "模範解答の詳細"
      }
    ]
  }
],
```

**★重要★ ミニ論文問題の登場人物設定:**
- **登場人物は必ずあたしンちキャラクターに変更**すること
- 法的内容や事案の現実性はそのまま維持する
- 単に名前だけを置き換える（例：「A社」→「タチバナ商事」、「田中」→「岩城」など）
- キャラクターの年齢や立場を考慮した現実的な設定にする

**ミニ論文でのキャラクター活用例:**
- 会社関係の事案：岩城、吉岡、理央の家族経営の会社
- 契約関係の事案：みかんとしみちゃんの間の売買契約
- 不法行為：藤野とナスオの部活動中の事故
- 相続関係：川島の祖父母の相続問題
- 刑法事案：ユズヒコが巻き込まれた軽微な事件
- 行政法：新田の家族が役所とのトラブル

## 🚨 絶対に避けるべきエラーパターン

### 1. 文法エラー
```javascript
// ❌ 間違い
{ type: 'dialogue', speaker: 'みかん', expression: 'normal' dialogue: 'セリフ' } // カンマ抜け

// ✅ 正しい
{ type: 'dialogue', speaker: 'みかん', expression: 'normal', dialogue: 'セリフ' }
```

### 2. 文字列エラー
```javascript
// ❌ 間違い - 物理的改行
content: `<div>
  内容
</div>`

// ✅ 正しい - \n使用
content: '<div>\n  内容\n</div>'
```

### 3. 未定義参照エラー
```javascript
// ❌ 間違い
{ type: 'dialogue', speaker: '田中', expression: 'normal', dialogue: 'セリフ' } // 存在しないキャラ

// ✅ 正しい
{ type: 'dialogue', speaker: 'みかん', expression: 'normal', dialogue: 'セリフ' }
```

### 4. HTMLエラー
```javascript
// ❌ 間違い - 閉じタグなし
content: '<div><p>内容</div>'

// ✅ 正しい
content: '<div><p>内容</p></div>'
```

### 5. 条文記述エラー
```javascript
// ❌ 間違い - 【】が不統一
dialogue: 'この場合、民法90条の公序良俗違反が問題になる'
dialogue: '【第90条】の規定によれば'
dialogue: '【民法第90条】の解釈は'
dialogue: '【民法90条第1項】では' // 「第」は項号のみ

// ✅ 正しい
dialogue: 'この場合、【民法90条】の公序良俗違反が問題になる【id:1】'
dialogue: '【民法90条】の規定によれば【id:2】'
dialogue: '【民法424条の3第2項】の要件は【id:3】'
dialogue: '【憲法14条】との関係で検討すると【id:4】'
```

## 📊 SVG作成の具体例

### フローチャート
```javascript
content: '<div style="background: #f8f9fa; padding: 20px; border-radius: 8px;"><svg width="100%" height="300" viewBox="0 0 600 300"><rect x="50" y="50" width="100" height="50" fill="#e3f2fd" stroke="#1976d2" rx="5"/><text x="100" y="80" text-anchor="middle" font-size="12">開始</text><path d="M 150 75 L 200 75" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/><defs><marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#333"/></marker></defs></svg></div>'
```

### 比較表
```javascript
content: '<div style="background: #f8fafc; padding: 20px; border-radius: 8px;"><table style="width: 100%; border-collapse: collapse; background: white;"><thead><tr style="background: #4a90e2; color: white;"><th style="padding: 12px; font-size: 12px;">項目</th><th style="padding: 12px; font-size: 12px;">内容</th></tr></thead><tbody><tr><td style="padding: 10px; border-bottom: 1px solid #e9ecef; background: #f8f9fa;">要件</td><td style="padding: 10px; border-bottom: 1px solid #e9ecef;">具体的要件</td></tr></tbody></table></div>'
```

## 🎯 分野別コンテンツガイド

### 憲法分野
- **重要概念**: 基本的人権、統治機構、違憲審査制
- **判例**: 最高裁判例中心
- **図表**: 権利の分類、審査基準、統治機構図

### 民法分野
- **重要概念**: 契約、物権、不法行為、親族相続
- **判例**: 最高裁・下級審判例
- **図表**: 契約関係図、時効期間表、親族関係図
- **🏛️ 債権関係図の特別ルール**:
  - **主債権**: 実線矢印（`-->`）で債権内容を明記
  - **付従的債権**: 点線矢印（`-..->`）で保証債権等を表現
  - **担保物権**: 太実線矢印（`==>`）で抵当権・質権等を表現
  - **矢印ラベル**: 具体的な法的根拠を記載（例：「売買契約に基づく引き渡し請求権」）

### 刑法分野
- **重要概念**: 構成要件、違法性、責任
- **判例**: 最高裁判例中心
- **図表**: 犯罪体系図、刑罰種類表

### 商法・会社法分野
- **重要概念**: 会社組織、資金調達、M&A
- **判例**: 最高裁・下級審判例
- **図表**: 会社組織図、手続フロー
- **🏛️ 商法特有の債権関係**: 民法の債権関係図ルールを準用し、手形・小切手関係では振出人→所持人の権利関係を実線で表現

### 民事訴訟法分野
- **重要概念**: 訴訟要件、証拠法、判決効
- **判例**: 最高裁判例中心
- **図表**: 訴訟手続フロー、管轄図

### 刑事訴訟法分野
- **重要概念**: 強制処分、証拠能力、判決手続
- **判例**: 最高裁判例中心
- **図表**: 捜査・公判手続フロー

### 行政法分野
- **重要概念**: 行政処分、行政指導、行政救済
- **判例**: 最高裁・下級審判例
- **図表**: 行政組織図、救済手続フロー

## ✅ 最終チェックリスト

作成完了前に以下を必ず確認：

### 構文チェック
- [ ] JavaScriptとして有効な構文
- [ ] すべてのオブジェクトプロパティにカンマ
- [ ] 文字列の開始・終了クォート一致
- [ ] 配列の角括弧閉じ忘れなし
- [ ] **🚨 Mermaidフローチャートの構文が正しい（最重要）**
  - [ ] テンプレートリテラル `\`flowchart TD` または `\`graph TD` または `\`graph LR` で開始
  - [ ] 開始行にノード定義を含めていない
  - [ ] 各ノードと接続が `\\n` で適切に改行されている
  - [ ] 判断ノードに `{}` と疑問符を使用
  - [ ] 一行に複数の接続を詰め込んでいない
  - [ ] ノード名が空欄の記法（`B[]` `C[]`）を使用していない
- [ ] HTMLとして有効な構文
- [ ] タグの入れ子構造が正しい
- [ ] 属性値のクォートが一致
- [ ] スクリプトやスタイルのタグが正しく配置

### コンテンツチェック
- [ ] 必須プロパティすべて存在
- [ ] キャラクター名が正確
- [ ] expression値が有効
- [ ] 【id:番号】形式の参照が正確
- [ ] HTMLタグが正しく閉じられている
- [ ] **条文記述が【法律名○条】形式で統一されている**
- [ ] **条文の項・号記述が正確である**

### ★重要★ 新規要件チェック
- [ ] **ストーリーが15〜25個の要素で構成されている（最重要）**
- [ ] **キャラクターの得意分野が最優先で考慮されている**
- [ ] **みかんやユズヒコの登場は必須ではなく、適切なキャラが選ばれている**
- [ ] **登場可能場所のルールが守られている**
- [ ] **しみちゃんやゆかりんなどのみかんのクラスメートとベア研メンバーにはかかわりはほとんどなく、少なくとも友達ではない。**
- [ ] **ゆかりんの話し方ルール（「～ね」「～よ」「しているね」「したよ」）が守られている**
- [ ] **しみちゃんのサバサバした性格が表現されている**
- [ ] **バラエティ豊かなキャラクターが登場している**
- [ ] **ミニ論文の登場人物があたしンちキャラクターになっている**
- [ ] **詳細な対話と場面描写が含まれている**
- [ ] **すべてのquestionsAndAnswersがミニ論文（quiz）に収録されている。複数の問題があればどこに何を入れても良い**
- [ ] **みかんの同級生の女子は全員みかんのことを「みかん」と呼び捨てにする。**
### 品質チェック
- [ ] 法的内容が正確
- [ ] 司法試験レベルに適合
- [ ] 教育的価値が高い
- [ ] キャラクターの個性が活かされている
- [ ] **ストーリーが十分に長く詳細である**
- [ ] **🎯 Mermaidフローチャートが効果的に活用されている**
  - [ ] 複雑な法的判断プロセスを視覚的に表現
  - [ ] 正しい構文で記述されている（構文エラーなし）
  - [ ] 判断ノード（菱形）と処理ノード（四角）を適切に使い分け
  - [ ] 横長（graph LR）または縦長（flowchart TD）を適切に選択
- [ ] **表とMermaidグラフのバランスが適切である**
- [ ] **AIキャラクター会話でのMermaidグラフ使用が期待できる内容である**
## モジュール作成ルール追加

- 🚫 **[4][5][6] のような参照番号・注釈は絶対に本文・解説・Q&A・ストーリー等に付与しないこと。**
- 🚫 **学術論文のような[3][4][5][6]などの文献参照番号を一切使用しないこと。**
- ✅ **全ての説明は注釈なしで完結する形で記述すること。**
## 🎯 出力形式の例

```javascript
export default {
  // =============================================
  // === 1. モジュール基本情報（必須） ============
  // =============================================
  id: "kenpou-example",
  title: "例題",
  category: "kenpou",
  citation: "みかん、ケンポウっ！？",
  rank: "A",
  tags: ["憲法", "人権"],
  rightSideCharacters: ['みかん'],

  // =============================================
  // === 2. 知識箱（必須） =======================
  // =============================================
  knowledgeBox: `知識内容`,

  // =============================================
  // === 3. 個別Q&A（必須） =====================
  // =============================================
  questionsAndAnswers: [
    { id: 1, rank: 'A', question: '質問', answer: '回答' }　//注意！絶対に送ったものと異なることを書いてはならない。まんま同じにしなければならない。
  ],

  // =============================================
  // === 4. 事案ストーリー（必須） ================
  // =============================================
  story: [
    { type: 'scene', text: '場面' },
    { type: 'dialogue', speaker: 'みかん', expression: 'normal', dialogue: 'セリフ' }
    //積極的に条文を出していこう！
  ],

  // =============================================
  // === 5. 判旨と解説（必須） ====================
  // =============================================
  explanation: `HTML解説`,

  // =============================================
  // === 6. ミニ論文問題（必須） ==================
  // =============================================
  quiz: [
    {
      title: "問題",
      rank: "A",
      background: `背景`,
      subProblems: [
        {
          title: "代理制度の基本と顕名",
          rank: "A",
          relatedQAs: [65, 67, 68, 70, 71, 74],
          problem: "有/。",
          hint: "代理制度の根幹をなす基礎理論が問われています。キーワードを正確に用いて説明してください。",
          points: ["有権代理の三要件【id:65】", "効果帰属の根拠（代理権本質説等）【id:68】", "行為の主体（代理人行為説等）【id:67】", "直接本人名による顕名の有効性【id:74】"],
          modelAnswer: "有権代理の要件は、①代理権の存在、②顕名、③代理権の範囲内の行為である【id:65】。効果帰属の根拠は、私的自治の拡張という代理制度の趣旨から、授権行為に求める代理権本質説等が有力である【id:68】。行為の主体は、【民法】の規定などから代理人自身と解する代理人行為説が通説・判例である【id:67】。代理人が本人の氏名のみを表示して行為した場合（直接本人名による顕名）も、相手方が代理関係を認識できる限り、顕名として有効と解されている【id:74】。"
        },
        {
          title: "代理権の濫用",
          rank: "A",
          relatedQAs: [81, 82],
          problem: "代理権の濫用の意義と効果について説明しなさい。また、代理権濫用行為の相手方から権利を取得した転得者を保護する法律構成についても述べなさい。",
          hint: "【民法107条】の解釈と、その後の第三者保護の問題です。",
          points: ["代理権の濫用の意義と効果（【民法107条】）【id:81】", "相手方の悪意・有過失", "転得者の保護", "【民法94条2項】の類推適用【id:82】"],
          modelAnswer: "代理権の濫用とは、代理人が自己又は第三者の利益を図る目的で代理権の範囲内の行為をすることである【id:81】。この場合、相手方がその目的について悪意又は有過失のときには、無権代理とみなされる（【民法107条】）。代理権濫用行為の相手方から権利を取得した善意の転得者は、【民法94条2項】の類推適用により保護されうる【id:82】。"
        }
      ]
    }
  ],

  // =============================================
  // === 7. 論文トレーニング（廃止） =============
  // =============================================
  essay: null
};
```

このプロンプトに従って、最新の情報をまんべんなく収集しながら、指定された法分野・テーマのモジュールを作成してください。エラーゼロ、司法試験・予備試験の教育効果最大を目指して、丁寧に作成をお願いします。
### 学習ファイルの元となるquestionsAndAnswersを以下に示します
これらは絶対に言葉遣い等を変えずに、そのまま反映させなさい！ぜったいにこの後示すquestionsAndAnswersを絶対に省略したり、意味を変えたりしてはならない。これは絶対的だ。また、空欄（{{}}による）は司法試験対策上重要な点にたくさん設けなさい！


では参りましょう。まずは、最初から　   storyまでをかけ。
 story: [
    { type: ???, text: ???
    ・・・・ //最低30回のやり取り、それ以上あればなおとても良い
    ????。",
    },

そして、私が「続き」と言ったらexplanation:以降の続きを書きなさい。
